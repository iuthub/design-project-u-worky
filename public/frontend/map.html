<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <title>Map - u-WORKY</title>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/mdb.min.css">
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,600,700,900" rel="stylesheet">
    <link rel="stylesheet" href="fonts/icomoon/icomoon.css" >
    <link rel="stylesheet" href="fonts/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="fonts/font-awesome/css/all.css">
  </head>

  <body>
    <header>
    <!-- Navbar -->
      <nav class="navbar navbar-expand-xl navbar-dark top-nav-collapse fixed-top">

        <a class="navbar-brand" href="index.html">
          <img src="img/logo.png" alt="u-WORKY" />
        </a>
  
        <!-- Collapse button -->
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#mainNav"
          aria-controls="mainNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
  
        <!-- Collapsible content -->
        <div class="collapse navbar-collapse" id="mainNav">

          <!-- Links -->
          <ul class="navbar-nav ml-auto d-flex">
            <li class="nav-item my-auto">
              <a class="nav-link" href="index.html"
                >Home
                <span class="sr-only">(current)</span>
              </a>
            </li>
  
            <!-- Dropdown -->
            <li class="nav-item dropdown my-auto">
              <a
                class="nav-link"
                id="navbarDropdownMenuLink"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                >Jobs</a
              >
              <div
                class="dropdown-menu dropdown-menu-center"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <a class="dropdown-item text-center" href="#">Job Categories</a>
                <a class="dropdown-item text-center" href="jobs-listing.html">Search for job</a>
                <a class="dropdown-item text-center" href="#">Find on Map</a>
              </div>
            </li>
            <!-- /Dropdown -->
  
            <li class="nav-item my-auto">
              <a class="nav-link" href="candidate-listing.html">Candidates</a>
            </li>
  
            <li class="nav-item my-auto">
              <a class="nav-link" href="#">Employers</a>
            </li>
  
            <li class="nav-item my-auto">
              <a class="nav-link" href="#">Contact us</a>
            </li>

            <li>
              <form class="form-inline">
                <div class="md-form container-fluid my-auto">
                  <button
                    type="button"
                    class="btn btn-primary btn-block btn-rounded"
                  >
                    Sign in
                  </button>
                </div>
              </form>
            </li>
          </ul>
          <!-- /Links -->
        </div>
        <!-- /Collapsible content -->
      </nav>
      <!-- /Navbar -->
    </header>


    <main>
      <div class="container-fluid search-map">
        <div class="row">


          <div class="col-xl-4 col-lg-5 col-md-6 order-xl-first order-lg-first order-md-first order-last search-map-left">
            <div class="container-fluid form-wrapper">
              <div class="content-search">

                <div class="card search-card">
                  <div class="card-body">
                    
                    <div class="form-location">
                      <div class="md-form form-input">
                          <input type="hidden" name="location-name" id="location-name" />
                          <input type="hidden" name="lat" id="lat" />
                          <input type="hidden" name="lng" id="lng" />
                          <input type="text" id="search" name="search" value="" class="form-control" oninput="onSearch(this.value)">
                        </div>
                        <select class="mdb-select md-form form-input colorful-select dropdown-primary" id="results" onchange="setMarker(this.value)">
                          <option value="" disabled selected>Location...</option>
                        </select>
                    </div>

                    <div class="form-distance-range">
                      <div class="row label-distance">
                        <div class="label-distance-left">
                          15 Km
                        </div>
                        <div class="label-distance-right">
                          100 Km
                        </div>
                      </div>
                      <div class="distance-range">
                        <form class="range-field w-100">
                          <input class="border-0" type="range" min="15" max="100" />
                        </form>
                      </div>
                    </div>

                    <div class="row search-filters">
                      <div class="col-lg-6 col-md-12 filter-item">
                        <select class="mdb-select md-form colorful-select dropdown-primary" id="search-filter-keyword" name="search-filter-keyword" multiple searchable="Search here...">
                          <option value="" disabled selected>Keywords...</option>
                          <option value="1">PHP</option>
                          <option value="2">Android</option>
                          <option value="3">IOS</option>
                          <option value="4">JavaScript</option>
                          <option value="5">Design</option>
                        </select>
                      </div>

                      <div class="col-lg-6 col-md-12 filter-item">
                        <select class="mdb-select md-form colorful-select dropdown-primary" id="search-filter-category" name="search-filter-category" searchable="Search here...">
                          <option value="" disabled selected>Category...</option>
                          <option value="1">IT &amp; Computer</option>
                          <option value="2">Finance &amp; Logistics</option>
                          <option value="3">Arts, Media, Design</option>
                          <option value="4">Education</option>
                          <option value="5">Engineering</option>
                        </select>
                      </div>

                      <div class="col-lg-6 col-md-12 filter-item">
                        <select class="mdb-select md-form colorful-select dropdown-primary" id="search-filter-type" name="search-filter-type">
                          <option value="" disabled selected>Job Type...</option>
                          <option value="1">Full-Time</option>
                          <option value="2">Part-Time</option>
                          <option value="3">Contract</option>
                          <option value="4">Internship</option>
                        </select>
                      </div>

                      <div class="col-lg-6 col-md-12 filter-item">
                        <select class="mdb-select md-form colorful-select dropdown-primary" id="search-filter-skills" name="search-filter-skills" multiple>
                          <option value="" disabled selected>Skills...</option>
                          <option value="1">Skill_1</option>
                          <option value="2">Skill_2</option>
                          <option value="3">Skill_3</option>
                          <option value="4">Skill_4</option>
                        </select>
                      </div>

                      <div class="col-lg-6 col-md-6 filter-item md-form form-input">
                        <input type="text" id="input-salary-from" name="input-salary-from" class="form-control">
                        <label for="input-salary-from" class="ml-3">Salary from...</label>
                      </div>

                      <div class="col-lg-6 col-md-6 filter-item md-form form-input">
                        <input type="text" id="input-salary-to" name="input-salary-to" class="form-control">
                        <label for="input-salary-to" class="ml-3">Salary to...</label>
                      </div>

                      <div class="col-12 d-flex justify-content-end">
                        <button type="button" class="btn btn-primary btn-search">Search<i class="fas fa-search pl-3" aria-hidden="true"></i></button>
                      </div>
                    </div>


                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <!-- Card -->
              <div class="col-lg-12 col-md-12 job">
                <div class="card">
                  <div class="row">
                    <!-- Card image -->
                    <div class="col-4 card-image-wrapper">
                      <div class="card-image">
                        <img src="img/employer-logo-netco.png" class="img-fluid" alt="">
                      </div>
                    </div>
                    <!--Card image -->

                    <div class="col-8">
                      <!-- Card content -->
                      <div class="card-body">
                        <!-- Category & Title -->
                        <h5 class="card-title"><strong><a href="">Senior PHP Web Developer</a></strong></h5>
                        <span class="badge badge-pill pink"><a href="#">FULL - TIME</a></span>
                        <!-- /Category & Title -->

                        <p>
                          <i class="fa fas fa-suitcase pr-3 mb-1 blue-text"></i>Netco Telecom<br>
                          <i class="fas fa-map-marker-alt pr-3 mb-1 red-text"></i>Tashkent, Mustakillik str. 5/1<br>
                          <i class="fas fa-money-bill pr-3 mb-1 green-text"></i>$1,500 - $2,000<br>
                        </p>
                      </div>
                      <!-- /Card content -->
                    </div>
                  </div>
                </div>
              </div>
              <!-- /Card -->
            </div>
          </div>

          <!-- MAP -->
          <div class="col-xl-8 col-lg-7 col-md-6 search-map-right">
            <div id="map" class="map-container h-100">
            </div>
          </div>
          <!-- /MAP -->

        </div>
      </div>
    </main>



    <!--  SCRIPTS  -->
    <!-- JQuery -->
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="js/mdb.js"></script>
    <!-- Places API -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC_EikIUgqB3NMPmITWXgHd9XOYEpBPnrw&callback=initMap&libraries=places" async defer> </script>
    
    <script>

      // Material Select Initialization
      $(document).ready(function() {
        $('.mdb-select').materialSelect();
      });

    </script>


    <script>
      let map, service;
      let values;
      const TASHKENT = {lat: 41.311081, lng: 69.240562};
      function initMap() {
          map = new google.maps.Map(document.getElementById('map'), {
              center: {lat: 41.311081, lng: 69.240562},
              zoom: 13
          });

          service =  new google.maps.places.PlacesService(map);
      }

      function onSearch(val) {
          if (val.length == 0) return;
          const request = {
              query: val,
              location: TASHKENT,
              radius: 15000,
              fields: ["name", "geometry"]
          }

          service.textSearch(request, (results, status) => {
              $("#results").empty();
              values = results;
          
              if (status === google.maps.places.PlacesServiceStatus.OK) {
                  results.forEach(element => {
                      let text = $(`
                          <option value="${element.id}">${element.name}</option>
                      `)

                      $("#results").append(text);
                  });
              }
      });
      }
      function setMarker(val) {
          console.log(val);
          values.forEach(element => {
              if (element.id == val) {
                  console.log(element);
                  let marker = new google.maps.Marker({
                      position: new google.maps.LatLng({lat: element.geometry.location.lat(), lng: element.geometry.location.lng()}),
                      animation: google.maps.Animation.DROP,
                      map: map
                  });
                  map.setCenter(element.geometry.location);

                  $("#location-name").val(element.formatted_address);
                  $("#lat").val(element.geometry.location.lat());
                  $("#lng").val(element.geometry.location.lng());
              }
          });
      }
    </script>
  </body>
</html>
